(()=>{"use strict";const t=[[[16,1,0,10],[19,1,0,7],[9,1,0,17],[13,1,0,13]],[[28,1,0,16],[34,1,0,10],[16,1,0,28],[22,1,0,22]],[[44,1,0,26],[55,1,0,15],[13,2,0,22],[17,2,0,18]],[[32,2,0,18],[80,1,0,20],[9,4,0,16],[24,2,0,26]],[[43,2,0,24],[108,1,0,26],[11,2,2,22],[15,2,2,18]],[[27,4,0,16],[68,2,0,18],[15,4,0,28],[19,4,0,24]],[[31,4,0,18],[78,2,0,20],[13,4,1,26],[14,2,4,18]],[[38,2,2,22],[97,2,0,24],[14,4,2,26],[18,4,2,22]],[[36,3,2,22],[116,2,0,30],[12,4,4,24],[16,4,4,20]],[[43,4,1,26],[68,2,2,18],[15,6,2,28],[19,6,2,24]],[[50,1,4,30],[81,4,0,20],[12,3,8,24],[22,4,4,28]],[[36,6,2,22],[92,2,2,24],[14,7,4,28],[20,4,6,26]],[[37,8,1,22],[107,4,0,26],[11,12,4,22],[20,8,4,24]],[[40,4,5,24],[115,3,1,30],[12,11,5,24],[16,11,5,20]],[[41,5,5,24],[87,5,1,22],[12,11,7,24],[24,5,7,30]],[[45,7,3,28],[98,5,1,24],[15,3,13,30],[19,15,2,24]],[[46,10,1,28],[107,1,5,28],[14,2,17,28],[22,1,15,28]],[[43,9,4,26],[120,5,1,30],[14,2,19,28],[22,17,1,28]],[[44,3,11,26],[113,3,4,28],[13,9,16,26],[21,17,4,26]],[[41,3,13,26],[107,3,5,28],[15,15,10,28],[24,15,5,30]],[[42,17,0,26],[116,4,4,28],[16,19,6,30],[22,17,6,28]],[[46,17,0,28],[111,2,7,28],[13,34,0,24],[24,7,16,30]],[[47,4,14,28],[121,4,5,30],[15,16,14,30],[24,11,14,30]],[[45,6,14,28],[117,6,4,30],[16,30,2,30],[24,11,16,30]],[[47,8,13,28],[106,8,4,26],[15,22,13,30],[24,7,22,30]],[[46,19,4,28],[114,10,2,28],[16,33,4,30],[22,28,6,28]],[[45,22,3,28],[122,8,4,30],[15,12,28,30],[23,8,26,30]],[[45,3,23,28],[117,3,10,30],[15,11,31,30],[24,4,31,30]],[[45,21,7,28],[116,7,7,30],[15,19,26,30],[23,1,37,30]],[[47,19,10,28],[115,5,10,30],[15,23,25,30],[24,15,25,30]],[[46,2,29,28],[115,13,3,30],[15,23,28,30],[24,42,1,30]],[[46,10,23,28],[115,17,0,30],[15,19,35,30],[24,10,35,30]],[[46,14,21,28],[115,17,1,30],[15,11,46,30],[24,29,19,30]],[[46,14,23,28],[115,13,6,30],[16,59,1,30],[24,44,7,30]],[[47,12,26,28],[121,12,7,30],[15,22,41,30],[24,39,14,30]],[[47,6,34,28],[121,6,14,30],[15,2,64,30],[24,46,10,30]],[[46,29,14,28],[122,17,4,30],[15,24,46,30],[24,49,10,30]],[[46,13,32,28],[122,4,18,30],[15,42,32,30],[24,48,14,30]],[[47,40,7,28],[117,20,4,30],[15,10,67,30],[24,43,22,30]],[[47,18,31,28],[118,19,6,30],[15,20,61,30],[24,34,34,30]]];function e(e,n){const r=t[e-1][n],o=[],l=r[0],i=r[1],s=r[2];for(let t=0;t<i;t++)o.push(l);for(let t=0;t<s;t++)o.push(l+1);return o}function n(e,n){return t[e-1][n][3]}const r=[[6],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];function o(t){const e=r[t-1],n=[],o=e.length-1;for(let t=0;t<e.length;t++)for(let r=0;r<e.length;r++)0==t&&0==r||t==o&&0==r||0==t&&r==o||n.push([e[t],e[r]]);return n}const l=[function(t,e){return(t+e)%2},function(t,e){return e%2},function(t,e){return t%3},function(t,e){return(t+e)%3},function(t,e){return(Math.floor(e/2)+Math.floor(t/3))%2},function(t,e){return t*e%2+t*e%3},function(t,e){return(t*e%3+t*e)%2},function(t,e){return(t*e%3+t+e)%2}],i=[1,2,4,8];function s(t,e){let n;return n=t<10?[10,9,8,8]:t<27?[12,11,16,10]:[14,13,16,12],n[e]}function c(t,e,n){return(e<6?e:e-1)%2==1?[e-1,n]:Math.floor((e<6?e:e-1)/2)%2==0?n===t-1?[e-1,n]:[e+1,n+1]:0===n?[7===e?5:e-1,n]:[e+1,n-1]}class u{constructor(t){this.next_bit=7,this.next_byte=0,this.bytes=new Uint8Array(t)}bits_written(){return 8*this.next_byte+(7-this.next_bit)}write_bit(t){this.bytes[this.next_byte]|=t<<this.next_bit,this.next_bit--,this.next_bit<0&&(this.next_bit=7,this.next_byte++)}write_bits(t,e){for(let n=e-1;n>=0;n--)this.write_bit(t>>>n&1)}get_bytes(){return this.bytes}}function f(t){let e=-1;for(;0!=t;)e++,t>>>=1;return e}const h=new class{constructor(t){let e=1<<f(t);this.modulus=e-1,this.exps=new Array(this.modulus),this.logs=new Array(this.modulus+1);let n=1;for(let r=0;r<this.modulus;r++)this.exps[r]=n,this.logs[n]=r,n<<=1,n&e&&(n^=t)}add(t,e){return t^e}subtract(t,e){return t^e}mult(t,e){return this.exps[(this.logs[t]+this.logs[e])%this.modulus]}inverse(t){return this.exps[this.modulus-this.logs[t]]}divide(t,e){return this.exps[(this.logs[t]+this.modulus-this.logs[e])%this.modulus]}power(t,e){let n=this.logs[t];return e<0&&(n-=this.modulus),this.exps[n*e%this.modulus]}}(285);class a{constructor(t){this.field=t}mult(t,e){const n=new Array(t.length+e.length-1);for(let r=0;r<t.length;r++)for(let o=0;o<e.length;o++)n[r+o]=this.field.add(n[r+o],this.field.mult(t[r],e[o]));return n}remainder(t,e){if(0==e.length)throw new Error("Division by zero");let n=0;const r=t.length-e.length+1;for(;n<r;){let r=this.field.divide(t[n],e[0]);for(let o=1;o<e.length;o++)t[n+o]=this.field.subtract(t[n+o],this.field.mult(e[o],r));n+=1}return t.slice(r)}generator(t){let e=[1];for(let n=0;n<t;n++)e=this.mult(e,[1,this.field.power(2,n)]);return e}}function d(t,e){return(t<<=f(e))^function(t,e){let n=f(t);const r=f(e);for(;n>=r;)n=f(t^=e<<n-r);return t}(t,e)}class g{constructor(t){this.extra_symbols=t,this.ring=new a(h),this.generator=this.ring.generator(t)}encode(t){let e=new Uint8Array(t.length+this.extra_symbols);for(let n=0;n<t.length;n++)e[n]=t[n];for(let n=0;n<this.extra_symbols;n++)e[t.length+n]=0;return this.ring.remainder(e,this.generator)}}const m=[function(t,e){},function(t,e){},function(t,e){for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);if(r>255)throw new Error("Invalid character");t.write_bits(r,8)}},function(t,e){}];function y(t){return t?1:2}function p(t,e,n,r,o){for(let l=0;l<r;l++)for(let i=0;i<r;i++)t[e+l][n+i]=o}function w(t,e,n){p(t,e,n,7,1),p(t,e+1,n+1,5,2),p(t,e+2,n+2,3,1)}function b(t,r,f,h){const a=function(t,e,n){const r=4*t+17,l=[];for(let t=0;t<r;t++){const t=new Uint8Array(r);t.fill(0),l.push(t)}p(l,0,0,8,2),p(l,r-8,0,8,2),p(l,0,r-8,8,2),w(l,0,0),w(l,r-7,0),w(l,0,r-7);for(let t=8;t<r-8;t++){const e=t%2==0?1:2;l[t][6]=e,l[6][t]=e}const i=o(t);for(let t=0;t<i.length;t++){const[e,n]=i[t];p(l,e-2,n-2,5,1),p(l,e-1,n-1,3,2),l[e][n]=1}if(t>=7){const e=function(t){return d(t,7973)}(t);!function(t,e){const n=t.length;let r=17;for(let o=0;o<6;o++)for(let l=0;l<3;l++)t[5-o][n-9-l]=y(e>>r&1),t[n-9-l][5-o]=y(e>>r&1),r-=1}(l,e)}const s=function(t,e){return 21522^d(t<<3^e,1335)}(e,n);return function(t,e){const n=t.length;for(let n=0;n<6;n++)t[n][8]=y(e>>14-n&1);for(let n=0;n<2;n++)t[7+n][8]=y(e>>8-n&1);t[8][7]=y(e>>6&1);for(let n=0;n<6;n++)t[8][5-n]=y(e>>5-n&1);for(let r=0;r<7;r++)t[8][n-1-r]=y(e>>14-r&1);for(let r=0;r<8;r++)t[n-8+r][8]=y(e>>7-r&1)}(l,s),l[8][r-8]=1,l}(t,r,f),b=function(t,r,o,l){const c=e(r,o);let f=c[c.length-1],h=0;for(let t=0;t<c.length;t++)h+=c[t];let a=new u(h);const d=8*h;a.write_bits(i[2],4);const y=s(r,2);a.write_bits(t.length,y),(0,m[2])(a,t);let p=a.bits_written();if(p>d)throw new Error("Message is too long");const w=Math.min(4,d-p);a.write_bits(0,w);const b=(p+w)%8;b>0&&a.write_bits(0,8-b),p=a.bits_written();let E=!0;for(let t=p;t<d;t+=8)E?a.write_bits(236,8):a.write_bits(17,8),E=!E;const v=[],_=[],x=n(r,o),I=new g(x);let B=0;const k=a.get_bytes();for(let t=0;t<c.length;t++){const e=c[t],n=k.slice(B,B+e);v.push(n),_.push(I.encode(n)),B+=e}const q=new Uint8Array(h+x*_.length);let M=0;for(let t=0;t<f;t++)for(let e=0;e<v.length;e++)t<v[e].length&&(q[M]=v[e][t],M+=1);for(let t=0;t<x;t++)for(let e=0;e<_.length;e++)q[M]=_[e][t],M+=1;return q}(h,t,r);return function(t,e,n){const r=t.length,o=function(t){const e=l[t];return function(t,n,r){return(e(t,n)>0?0:1)^r}}(n);let[i,s]=[r-1,r-1];for(let n=0;n<e.length;n++)for(let l=0;l<8;l++){for(;0!==t[i][s];)[i,s]=c(r,i,s);let u=e[n]>>7-l&1;t[i][s]=y(o(i,s,u)),[i,s]=c(r,i,s)}for(;i>=0;)0===t[i][s]&&(t[i][s]=y(o(i,s,0))),[i,s]=c(r,i,s)}(a,b,f),a}const E=["white","blue","cyan","purple","teal","yellow","orange","gray","red","brown","pink"];document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("qr-message"),r=document.getElementById("qr-version"),l=document.getElementById("qr-mode"),i=document.getElementById("qr-mask"),u=document.getElementById("qr-display"),f=document.getElementById("qr-canvas"),h=f.getContext("2d"),a=document.getElementById("qr-download"),d=new Array(11);d[1]=document.getElementById("qr-position-patterns"),d[2]=document.getElementById("qr-separator-patterns"),d[3]=document.getElementById("qr-alignment-patterns"),d[4]=document.getElementById("qr-timing-patterns"),d[5]=document.getElementById("qr-format-patterns"),d[6]=document.getElementById("qr-version-patterns"),d[7]=document.getElementById("qr-black-square-patterns"),d[8]=document.getElementById("qr-data-patterns"),d[9]=document.getElementById("qr-error-patterns"),d[10]=document.getElementById("qr-extra-white-patterns");const g=document.getElementById("qr-patterns-show"),m=document.getElementById("qr-patterns-hide"),y=document.getElementById("qr-data-path"),p=document.getElementById("qr-zigzag"),w=document.getElementById("qr-data-groups");let v=null,_=null,x=null;function I(){const a=t.value,g=[1,0,3,2][parseInt(l.value)];let m=parseInt(r.value);0===m&&(m=function(t,n,r){let o=1,l=40;for(;l>o;){const r=Math.floor((l+o)/2),i=e(r,n);let c=0;for(let t=0;t<i.length;t++)c+=i[t];c-=1,c-=Math.floor(s(r,2)/8),t>c?o=r+1:l=r}return l}(a.length,g),x!==m&&(_=null,x=m));const I=parseInt(i.value);try{v||(v=b(m,g,I,a))}catch(t){const e=400,n=window.devicePixelRatio??1;f.setAttribute("width",String(e*n)),f.setAttribute("height",String(e*n)),f.style.setProperty("width",e+"px"),f.style.setProperty("height",e+"px");const r=new DOMMatrix(`scale(${n})`);return h.setTransform(r),h.clearRect(0,0,e,e),h.fillStyle="red",h.beginPath(),h.arc(e/2,e/2,e/4,0,2*Math.PI),h.fill(),h.fillStyle="black",h.font="24px sans-serif",h.textAlign="center",h.textBaseline="bottom",h.fillText(t.message,e/2,e-60),h.beginPath(),h.strokeStyle="white",h.lineWidth=20,h.moveTo(e/2-60,e/2-60),h.lineTo(e/2+60,e/2+60),h.moveTo(e/2+60,e/2-60),h.lineTo(e/2-60,e/2+60),void h.stroke()}const B={};for(let t=1;t<11;t++)B[t]=d[t].checked;const k={show_path:y.checked,show_group:w.checked,show_zigzag:p.checked,display_mode:parseInt(u.value),show_patterns:B};_||(_=function(t,r){const l=4*t+17,i=new Array(l);for(let t=0;t<l;t++){const e=new Uint8Array(l);e.fill(0),i[t]=e}for(let t=0;t<8;t++)for(let e=0;e<8;e++)i[t][e]=2,i[t][l-1-e]=2,i[l-1-t][e]=2;for(let t=0;t<7;t++)for(let e=0;e<7;e++)i[t][e]=1,i[t][l-1-e]=1,i[l-1-t][e]=1;for(let t=0;t<8;t++)i[t][8]=5,i[8][t]=5,i[l-1-t][8]=5,i[8][l-1-t]=5;if(i[8][8]=5,t>=7)for(let t=0;t<6;t++)for(let e=0;e<3;e++)i[t][l-9-e]=6,i[l-9-e][t]=6;for(let t=8;t<l-8;t++)i[t][6]=4,i[6][t]=4;i[8][l-8]=7;const s=o(t);for(let t=0;t<s.length;t++){const e=s[t][0],n=s[t][1];for(let t=-2;t<3;t++)for(let r=-2;r<3;r++)i[e+t][n+r]=3}const u=[],f=[],h=e(t,r);let a=0;for(let t=0;t<h.length;t++)a+=h[t];const d=n(t,r)*h.length;let[g,m]=[l-1,l-1];for(let t=0;t<a;t++){const t=[];for(let e=0;e<8;e++){for(;0!==i[g][m];)[g,m]=c(l,g,m);i[g][m]=8,t.push([g,m]),[g,m]=c(l,g,m)}u.push(t)}for(let t=0;t<d;t++){const t=[];for(let e=0;e<8;e++){for(;0!==i[g][m];)[g,m]=c(l,g,m);i[g][m]=9,t.push([g,m]),[g,m]=c(l,g,m)}f.push(t)}for(;g>=0;)0===i[g][m]&&(i[g][m]=10),[g,m]=c(l,g,m);return[i,u,f]}(m,g)),function(t,e,n,r){const o=r.max_qr_size||720,l=r.margin||40,i=r.max_module_size||15,s=r.display_mode||0,u=e.length,f=Math.min(Math.floor(o/u),i),h=t.getContext("2d"),a=u*f+2*l,d=window.devicePixelRatio??1;t.setAttribute("width",String(a*d)),t.setAttribute("height",String(a*d)),t.style.setProperty("width",a+"px"),t.style.setProperty("height",a+"px");const g=new DOMMatrix(`scale(${d})`);if(h.setTransform(g),h.fillStyle="white",h.fillRect(0,0,t.width,t.height),h.fillStyle="black",0===s)for(let t=0;t<u;t++)for(let n=0;n<u;n++)1===e[t][n]&&h.fillRect(l+t*f,l+n*f,f,f);else for(let t=0;t<u;t++)for(let n=0;n<u;n++)if(1===e[t][n]){if(h.beginPath(),h.arc(t*f+l+f/2,n*f+l+f/2,f/2,0,2*Math.PI),h.fill(),2===s)for(let r=0;r<2;r++)for(let o=0;o<2;o++){const i=2*r-1,s=2*o-1;let c=t+i>=0&&t+i<u&&1===e[t+i][n];c=c||n+s>=0&&n+s<u&&1===e[t][n+s],c=c||(t+n)%2==0&&t+i>=0&&t+i<u&&n+s>=0&&n+s<u&&1===e[t+i][n+s],c&&h.fillRect(t*f+l+r*f/2,n*f+l+o*f/2,f/2,f/2)}}else if(2===s){for(let r=0;r<2;r++)for(let o=0;o<2;o++){const i=2*r-1,s=2*o-1;let c=t+i>=0&&t+i<u&&1===e[t+i][n];c=c&&n+s>=0&&n+s<u&&1===e[t][n+s],(t+n)%2==0&&(c=c&&1===e[t+i][n+s]),c&&h.fillRect(t*f+l+r*f/2,n*f+l+o*f/2,f/2,f/2)}h.fillStyle="white",h.beginPath(),h.arc(t*f+l+f/2,n*f+l+f/2,f/2,0,2*Math.PI),h.fill(),h.fillStyle="black"}const m=r.show_group||!1,y=r.show_zigzag||!1,p=r.show_path||!1;let w=!1;const b={};for(let t=1;t<11;t++)b[t]=r.show_patterns&&r.show_patterns[t]||!1,w=w||b[t];if(w){const t=n[0];h.globalAlpha=.5;for(let e=0;e<u;e++)for(let n=0;n<u;n++){const r=t[e][n];b[r]&&(h.fillStyle=E[r],h.fillRect(l+e*f,l+n*f,f,f))}h.globalAlpha=1}if(y){let t=u-1,e=u-1,[n,r]=c(u,t,e);for(;n>=0;)h.beginPath(),h.strokeStyle="gray",h.lineWidth=2,h.moveTo(l+t*f+f/2,l+e*f+f/2),h.lineTo(l+n*f+f/2,l+r*f+f/2),h.stroke(),t=n,e=r,[n,r]=c(u,t,e)}if(p){let t=null,e=null;for(const r of n[1])for(const[n,o]of r)null!==t&&(h.beginPath(),h.strokeStyle="red",h.lineWidth=2,h.moveTo(l+t*f+f/2,l+e*f+f/2),h.lineTo(l+n*f+f/2,l+o*f+f/2),h.stroke()),t=n,e=o;for(const r of n[2])for(const[n,o]of r)h.beginPath(),h.strokeStyle="red",h.lineWidth=2,h.moveTo(l+t*f+f/2,l+e*f+f/2),h.lineTo(l+n*f+f/2,l+o*f+f/2),h.stroke(),t=n,e=o}if(m){const t=[0,0,1,0],e=[1,1,1,0],r=[1,0,0,0],o=[1,0,1,1];for(let l=1;l<=2;l++)for(const i of n[l])for(let n=0;n<i.length;n++){const[l,s]=i[n],c=[!0,!0,!0,!0];for(let t=0;t<i.length;t++){const[e,n]=i[t];l===e?s===n-1?c[0]=!1:s===n+1&&(c[1]=!1):s===n&&(l===e-1?c[2]=!1:l===e+1&&(c[3]=!1))}for(let n=0;n<4;n++)c[n]&&(h.beginPath(),h.strokeStyle="red",h.lineWidth=2,h.moveTo(40+(l+t[n])*f,40+(s+r[n])*f),h.lineTo(40+(l+e[n])*f,40+(s+o[n])*f),h.stroke())}}}(f,v,_,k)}t.addEventListener("input",(function(){v=null,I()})),r.addEventListener("input",(function(){v=null,_=null;let t=this.value;"0"===t&&(t="Min"),this.nextElementSibling.value=t,I()})),l.addEventListener("input",(function(){v=null,_=null,this.nextElementSibling.value=["L","M","Q","H"][parseInt(this.value)],I()})),i.addEventListener("input",(function(){v=null,this.nextElementSibling.value=this.value,I()})),u.addEventListener("input",(function(){I()})),a.addEventListener("click",(function(){const t=f.toDataURL("image/png");this.download="qr.png",this.href=t}),!1),g.addEventListener("click",(function(t){const e=document.getElementById("patterns-controls").getElementsByTagName("input");for(let t=0;t<e.length;t++)e.item(t).checked=!0;return I(),t.preventDefault(),!1}),!1),m.addEventListener("click",(function(t){const e=document.getElementById("patterns-controls").getElementsByTagName("input");for(let t=0;t<e.length;t++)e.item(t).checked=!1;return I(),t.preventDefault(),!1}),!1);for(let t=1;t<d.length;t++)d[t].addEventListener("change",I);y.addEventListener("change",I),p.addEventListener("change",I),w.addEventListener("change",I),I()}))})();